<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test: Preformatted Text Preservation</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background: #f5f5f5;
    }
    h1 { color: #1a1a1a; border-bottom: 3px solid #4caf50; padding-bottom: 10px; }
    .intro { background: #e8f5e9; padding: 15px; border-left: 4px solid #4caf50; margin: 20px 0; }
    .test-case { background: white; border: 1px solid #ddd; border-radius: 8px; margin: 20px 0; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .test-case h2 { color: #333; font-size: 20px; margin-top: 0; }
    .expected { background: #fff3e0; border-left: 4px solid #ff9800; padding: 12px; margin: 15px 0; font-family: 'Courier New', monospace; font-size: 13px; white-space: pre-wrap; }
    pre { background: #263238; color: #aed581; padding: 15px; border-radius: 4px; overflow-x: auto; }
    code { background: #e0e0e0; padding: 2px 6px; border-radius: 3px; font-family: 'Courier New', monospace; }
  </style>
</head>
<body>

<!--
================================================================================
TEST FILE METADATA
================================================================================
FILE: preformatted.html
PURPOSE: Validate whitespace preservation in PRE/CODE/TEXTAREA elements
TECHNICAL: Tests PREFORMATTED set detection in DOM walking function
TEST COUNT: 5 preformatted scenarios
EXPECTED RESULT: Exact whitespace preserved in preformatted blocks
UPDATED: 2025-12-22
================================================================================
-->

  <h1>Preformatted Text Preservation Tests</h1>

  <div class="intro">
    <p><strong>Purpose:</strong> Validate that <code>get_page_text()</code> preserves exact whitespace in preformatted elements.</p>
    <p><strong>Elements tested:</strong> PRE, CODE, TEXTAREA</p>
    <p><strong>Expected:</strong> Indentation, multiple spaces, and line breaks should be preserved exactly.</p>
  </div>

  <!-- ===================================================================== -->
  <!-- TEST 1: PRE Element with Code                                         -->
  <!-- ===================================================================== -->

  <section id="test-1" class="test-case">
    <h2>Test 1: PRE Element with Code</h2>

    <div class="expected">Expected: Exact indentation preserved in code block</div>

    <div class="actual">
      <p>Preformatted Test 1 passed: Code block below should preserve exact formatting:</p>
<pre>
function example() {
    const    spaces   =   "multiple";
    if (true) {
        return   spaces;
    }
}
</pre>
    </div>
  </section>

  <!-- ===================================================================== -->
  <!-- TEST 2: CODE Element Inline                                           -->
  <!-- ===================================================================== -->

  <section id="test-2" class="test-case">
    <h2>Test 2: CODE Element Inline</h2>

    <div class="expected">Expected: Inline code preserved</div>

    <div class="actual">
      <p>Preformatted Test 2 passed: This paragraph contains inline code: <code>const x = 1;</code> and <code>let   y   =   2;</code> which should preserve spaces.</p>
    </div>
  </section>

  <!-- ===================================================================== -->
  <!-- TEST 3: TEXTAREA Content                                              -->
  <!-- ===================================================================== -->

  <section id="test-3" class="test-case">
    <h2>Test 3: TEXTAREA Content</h2>

    <div class="expected">Expected: Textarea content with line breaks preserved</div>

    <div class="actual">
      <p>Preformatted Test 3 passed: Textarea content below:</p>
      <textarea rows="5" cols="50" readonly>Line 1 of textarea
Line 2 with    multiple    spaces
Line 3 with	tabs
    Indented line 4
Line 5 end</textarea>
    </div>
  </section>

  <!-- ===================================================================== -->
  <!-- TEST 4: Nested PRE inside DIV                                         -->
  <!-- ===================================================================== -->

  <section id="test-4" class="test-case">
    <h2>Test 4: Nested PRE inside DIV</h2>

    <div class="expected">Expected: PRE preserved, surrounding DIV normalized</div>

    <div class="actual">
      <div>
        <p>Preformatted Test 4 passed: Regular text before PRE (normalized).</p>
<pre>
    Indented PRE content
        More indentation
            Even more
</pre>
        <p>Regular text after PRE (normalized).</p>
      </div>
    </div>
  </section>

  <!-- ===================================================================== -->
  <!-- TEST 5: Mixed Preformatted and Regular                                -->
  <!-- ===================================================================== -->

  <section id="test-5" class="test-case">
    <h2>Test 5: Mixed Preformatted and Regular</h2>

    <div class="expected">Expected: PRE blocks preserved, regular text normalized</div>

    <div class="actual">
      <p>Preformatted Test 5 passed: This     text     has     multiple     spaces     but     should     normalize.</p>
<pre>
This    PRE    block    keeps    its    spaces
</pre>
      <p>Back to regular text that should be normalized again.</p>
    </div>
  </section>

  <footer style="margin-top: 40px; padding: 20px; background: #f0f0f0; border-radius: 8px;">
    <h2>Validation Checklist</h2>
    <ul>
      <li>"Preformatted Test 1 passed" - PRE code block</li>
      <li>"Preformatted Test 2 passed" - inline CODE</li>
      <li>"Preformatted Test 3 passed" - TEXTAREA content</li>
      <li>"Preformatted Test 4 passed" - nested PRE in DIV</li>
      <li>"Preformatted Test 5 passed" - mixed formatting</li>
    </ul>
  </footer>

</body>
</html>